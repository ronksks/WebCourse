<!DOCTYPE html>
<html>
<head>
    <title>JSON examples</title>
    <style>
        label {
            display: inline-block;
            width: 100px;
        }

        #selctedData span {
            font-weight: bold;
        }
    </style>
    <script src="include/jquery.js"></script>
    <script>
        var example1 = '{ "students" : [' +
            '{ "First Name":"David" , "Last Name":"Berman", "Age":18 },' +
            '{ "First Name":"Anna" , "Last Name":"Smith", "Age":27 },' +
            '{ "First Name":"Peter" , "Last Name":"Jones", "Age":23 } ]}';
        var obj = JSON.parse(example1);

        // alternative
        var example2 = {
            "students": [
                { "First Name": "David", "Last Name": "Berman", "Age": 18 },
                { "First Name": "Anna", "Last Name": "Smith", "Age": 27 },
                { "First Name": "Peter", "Last Name": "Jones", "Age": 23 }
            ]
        }

        function gen_selections() {
            console.log(obj);
            $.each(obj["students"], function (i, o) {
                var opt = $("<option/>");
                $(opt).val(i);
                $(opt).text(o["First Name"] + " " + o["Last Name"]);
                $("#selStudents").append(opt);
            })
        }

        function update_student() {
            console.log("update_student");
            var n = parseInt($("#selStudents").find("option:selected").val());
            $("input").each(function (i, e) {
                console.log(i + " " + $(e).attr("data-id") + " " + $(e).val());
                var att = $(e).attr("data-id");
                var new_val = $(e).val();
                obj["students"][n][att] = new_val;
                $("#selStudents").empty();
                gen_selections();
            })
        }
        $(document).ready(function () {

            gen_selections()

            $("#selStudents").change(function () {
                var n = parseInt($(this).find("option:selected").val());
                var student = obj["students"][n];
                var s = "";
                for (var propertyName in student) {
                    //s += "<div><label>" + propertyName + "</label><span>" + student[propertyName] + "</span></div>";
                    s += "<div><label>" + propertyName + "</label><span><input type ='text' data-id='" + propertyName + "' value='" + student[propertyName] + "'/></span></div>";
                    var n = parseInt($(this).find("option:selected").val());
               //     obj["students"][n][propertyName]=
                    //this.student.propertyName=
                    // student.propertyName=data-id
                    //obj["students"][n]
                }
                s += "<div><button onclick='update_student()'>save</button></div>";
                $("#selctedData").html(s);
            })
        })
    </script>
</head>
<body>
    <div id="" style="width:400px;margin:30px auto">
        <div style="float:left">
            <select id="selStudents" multiple></select>
        </div>
        <div style="float:left;margin-left:20px;" id="selctedData">
            select student ..
        </div>
        <div style="clear:both"></div>
    </div>
</body>
</html>
