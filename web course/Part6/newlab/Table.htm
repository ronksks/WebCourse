<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>Editable Table</title>
    <link href="inc/bootstrap.min.css" rel="stylesheet" />
    <script src="inc/jquery-3.0.0.min.js"></script>
    <script>
        var Students = [];
        $(function () {
            var st = localStorage["students"];
            if (st != undefined) {
                Students = JSON.parse(st);
            }
            Show(Students.length > 0);
            $.each(Students, function (i,s) {
                    AddStudentRow(s);                   
            });
            $("#divTemp").hide();
            
        });


        function Show(isShown) {
            if (isShown) {
                $("#tbStudents").show();                
                $("#divEmpty").hide();
            } else {
                $("#tbStudents").hide();
                $("#divEmpty").show();
            }
        }

        var selectedStudent;
        function AddNew() {
            var tr = $("<tr/>");
            $(tr).addClass("edit");
            $.each($("#tbStudents th"), function (i, o) {
                var td = $("<td/>");
                if (i == 0) 
                    $(td).text(Students.length + 1);
                else {
                    var inp = $("<input class='form-control'/>");
                    $(td).append(inp);
                }
                $(tr).append(td);
            });
            $("#tbStudents").find("tbody").append(tr);
            $("#divTemp").show();
            Show(true);
        }

        function Save() {
            // create new student
            var tr = $("#tbStudents tbody tr:last-child");
            var inp = $("#tbStudents tbody tr:last-child td input");
            var student = {
                Id: $("#tbStudents tbody tr").length,
                Name: $(inp).eq(0).val(),
                Age:  $(inp).eq(1).val(),
                Address:  $(inp).eq(2).val()
            }
            Students.push(student);
            // save to localstorage
            localStorage["students"] = JSON.stringify(Students);

            AddStudent(student);
            
            $("#divTemp").hide();
        }
        function Cancel() {
            //var tr = $("#tbStudents tbody tr:last-child");
            var tr = $("#tbStudents tbody tr.edit");
            $(tr).remove();
            $("#divTemp").hide();
            Show(Students.length > 0);
        }

        function AddStudent(student) {
            AddStudentRow(student);
            Cancel();
        }

        function AddStudentRow(student) {
             var tr = $("<tr/>");            
            var td1 = $("<td/>");
            $(td1).text(student.Id);
            $(tr).append(td1);

            var td2 = $("<td/>");
            $(td2).text(student.Name);
            $(tr).append(td2);

             var td3 = $("<td/>");
            $(td3).text(student.Age);
            $(tr).append(td3);

            var td4 = $("<td/>");
            $(td4).text(student.Address);
            $(tr).append(td4);

            $("#tbStudents tbody").append(tr);
        }

    </script>
</head>
<body>
    <div class="container">
        <div><small>Editable table example</small></div>
        <nav class="navbar navbar-expand-lg navbar-dark bg-primary">
            <a class="navbar-brand" href="#">Navbar</a>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarColor01" aria-controls="navbarColor01" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>

            <div class="collapse navbar-collapse" id="navbarColor01">
                <ul class="navbar-nav mr-auto">
                    <li class="nav-item active">
                        <a class="nav-link" href="#">Home <span class="sr-only">(current)</span></a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#">Features</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#">Pricing</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#">About</a>
                    </li>
                </ul>
                <form class="form-inline my-2 my-lg-0">
                    <input class="form-control mr-sm-2" type="text" placeholder="Search">
                    <button class="btn btn-secondary my-2 my-sm-0" type="submit">Search</button>
                </form>
            </div>
        </nav>
        <h1>Students</h1>
        <hr />
        <div>
            <div style="float:left">
                <button class="btn btn-info" onclick="AddNew()">Add New</button>
            </div>
            <div style="float:right" id="divTemp">
                <button class="btn btn-success" onclick="Save()">Save</button>
                <button class="btn btn-danger" onclick="Cancel()">Cancel</button>
            </div>
            <div style="clear:both"></div>
            
        </div>
        <table id="tbStudents" class="table table-bordered table-sm" style="margin-top:20px;">
            <thead>
                <tr>
                    <th style="width:30px">N#</th>
                    <th style="width:120px">Name</th>
                    <th style="width:60px">Age</th>
                    <th>Address</th>
                </tr>
            </thead>
            <tbody>

            </tbody>
        </table>
        <div class="text-center" id="divEmpty">No students in db..</div>
    </div>


</body>
</html>